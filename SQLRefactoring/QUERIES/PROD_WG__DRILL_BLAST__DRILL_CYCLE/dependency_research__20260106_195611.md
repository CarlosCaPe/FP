# Dependency research: PROD_WG.DRILL_BLAST.DRILL_CYCLE (VIEW)

Generated (UTC): 2026-01-06T19:56:11Z

Found 1 Dynamic Table dependency(ies).

## PROD_TARGET.COLLECTIONS.DRILLBLAST_DRILL_CYCLE_DT
- refresh_mode: FULL
- target_lag: 5 minutes
- warehouse: WH_BATCH_DE
- name: DRILLBLAST_DRILL_CYCLE_DT
- database_name: PROD_TARGET
- schema_name: COLLECTIONS
- path: PROD_WG.DRILL_BLAST.DRILL_CYCLE[VIEW] -> PROD_TARGET.COLLECTIONS.DRILLBLAST_DRILL_CYCLE_V[VIEW] -> PROD_TARGET.COLLECTIONS.DRILLBLAST_DRILL_CYCLE_DT[DYNAMIC TABLE]

DDL (from GET_DDL):
```sql
create or replace dynamic table DRILLBLAST_DRILL_CYCLE_DT(
	ORIG_SRC_ID,
	SITE_CODE,
	BENCH,
	PUSHBACK,
	PATTERN_NAME,
	ORIGINAL_PATTERN_NAME,
	DRILL_CYCLE_SK,
	DRILL_HOLE_SHIFT_ID,
	DRILL_ID,
	DRILL_BIT_ID,
	SYSTEM_OPERATOR_ID,
	DRILL_HOLE_ID,
	DRILL_HOLE_NAME,
	DRILL_PLAN_SK,
	DRILL_HOLE_STATUS,
	IS_HOLE_PLANNED_FLAG,
	START_HOLE_TS_UTC,
	END_HOLE_TS_UTC,
	START_HOLE_TS_LOCAL,
	END_HOLE_TS_LOCAL,
	DRILL_HOLE_DURATION_SECONDS,
	ACTUAL_DRILL_HOLE_DEPTH_FEET,
	ACTUAL_DRILL_HOLE_DEPTH_METERS,
	GPS_ACCURACY,
	ACTUAL_DRILL_HOLE_START_FEET_X,
	ACTUAL_DRILL_HOLE_START_FEET_Y,
	ACTUAL_DRILL_HOLE_START_FEET_Z,
	ACTUAL_DRILL_HOLE_END_FEET_X,
	ACTUAL_DRILL_HOLE_END_FEET_Y,
	ACTUAL_DRILL_HOLE_END_FEET_Z,
	ACTUAL_DRILL_HOLE_LONGITUDE,
	ACTUAL_DRILL_HOLE_LATITUDE,
	ACTUAL_DRILL_HOLE_START_METERS_X,
	ACTUAL_DRILL_HOLE_START_METERS_Y,
	ACTUAL_DRILL_HOLE_START_METERS_Z,
	ACTUAL_DRILL_HOLE_END_METERS_X,
	ACTUAL_DRILL_HOLE_END_METERS_Y,
	ACTUAL_DRILL_HOLE_END_METERS_Z,
	AUTODRILL_DURATION_SECONDS,
	AUTODRILL_USAGE_PCT,
	DRILL_HOLE_PENETRATION_RATE_AVG_FEET_HOUR,
	OPERATOR_LOGIN_TS_UTC,
	OPERATOR_LOGOUT_TS_UTC,
	OPERATOR_LOGIN_TS_LOCAL,
	OPERATOR_LOGOUT_TS_LOCAL,
	BEARING,
	DRILL_TOWER_ANGLE_DEGREE_CALCULATED,
	DRILL_TOWER_ANGLE_DEGREE_SYSTEM,
	DRILL_HOLE_DUPLICATED_FLAG,
	DRILL_HOLE_UPSIDE_DOWN_FLAG,
	DRILL_HOLE_START_END_TIME_INVALID_FLAG,
	DRILL_HOLE_START_END_TIME_OVERLAP_FLAG,
	DRILL_HOLE_DEPTH_INVALID_FLAG,
	DRILL_HOLE_ANGLE_INVALID_FLAG,
	DRILL_HOLE_POSITION_INVALID_FLAG,
	TIME_BETWEEN_DRILL_HOLES_SECONDS,
	AIR_PRESSURE_PSI,
	FEED_FORCE_NEWTONS,
	ROTATION_TORQUE_NM,
	BIT_SPEED_RPM,
	WATER_FLOW_GPM,
	INSTANTANOUS_PENRATE_MWD_METERS_HOUR,
	INSTANTANOUS_PENRATE_MWD_FEET_HOUR,
	DRILL_HOLE_OFF_TARGET_FEET,
	DRILL_HOLE_OFF_TARGET_METERS,
	DRILL_HOLE_HORIZONTAL_ACCURACY_PCT,
	DRILL_HOLE_VERTICAL_ACCURACY_PCT,
	OVERDRILL_UNDERDRILL_FLAG,
	OVERDRILL_UNDERDRILL_FEET,
	OVERDRILL_UNDERDRILL_METERS,
	DRILLING_STOPS_COUNT,
	DRILL_HOLE_REDRILL_FLAG,
	PROPEL_START_TS_UTC,
	PROPEL_END_TS_UTC,
	PARK_POSITION_START_TS_UTC,
	PARK_POSITION_END_TS_UTC,
	LEVEL_START_TS_UTC,
	LEVEL_END_TS_UTC,
	DRILL_START_TS_UTC,
	DRILL_END_TS_UTC,
	RETRACT_START_TS_UTC,
	RETRACT_END_TS_UTC,
	PROPEL_START_TS_LOCAL,
	PROPEL_END_TS_LOCAL,
	PARK_POSITION_START_TS_LOCAL,
	PARK_POSITION_END_TS_LOCAL,
	LEVEL_START_TS_LOCAL,
	LEVEL_END_TS_LOCAL,
	DRILL_START_TS_LOCAL,
	DRILL_END_TS_LOCAL,
	RETRACT_START_TS_LOCAL,
	RETRACT_END_TS_LOCAL,
	PROPEL_DURATION,
	PARK_POSITION_DURATION,
	LEVEL_DURATION,
	DRILL_DURATION,
	RETRACT_DURATION,
	SYSTEM_DRILL_STATE_DURATION_SECONDS,
	SYSTEM_SETUP_STATE_DURATION_SECONDS,
	SYSTEM_AUTO_LEVEL_DURATION_SECONDS,
	SYSTEM_AUTO_DELEVEL_DURATION_SECONDS,
	PLAN_CREATION_TS_LOCAL,
	SYSTEM_VERSION,
	ACTUAL_MCF_BLOCK_ID,
	DESIGN_MCF_BLOCK_ID,
	DW_LOAD_TS,
	DW_MODIFY_TS
) target_lag = '5 minutes' refresh_mode = AUTO initialize = ON_CREATE warehouse = WH_BATCH_DE
 as
/***************************************************************************************************************************************************
* TABLE NAME: PROD_TARGET.COLLECTIONS.DRILLBLAST_DRILL_CYCLE_DT
* PURPOSE:  This dynamic table Centralizes information about drilling cycles from CAT Terrain And Surface manager source systems.
* Note:		This designs overlap with other source systems generting cycles at the same time for the same holes. Hence adding system version as part of PK.
* SITE: 	
* Usage:  	Select * from PROD_TARGET.COLLECTIONS.DRILLBLAST_DRILL_CYCLE_DT limit 10;
* Primary Key :  orig_src_id,site_code,  drill_hole_shift_id, system_version , dw_drill_id, drill_hole_id
* CREATE/CHANGE LOG :  
* DATE             MOD BY               GCC                                                 DESC
*--------------------------------------------------------------------------------------------------------------------------------------------------
* 2025-08-01    MURALI NAIDU           Drill Productivity Data Model             Initial version 
* 2025-08-26    MURALI NAIDU           Drill Productivity Data Model             Repointng to PROD_general.target ( fuse is not able to handle archival process now, will repoint to surfacemanager once fuse able to handle archival data)
* 2025-10-27    Murali Naidu           Drill Productivity Data Model              Adding Dimensional columns to the drill cycle view
* 2025-10-27    Murali Naidu           Drill Productivity Data Model              Renaming columns as per ethan's request
* 2025-11-24    Murali Naidu           Drill Productivity Data Model              Repointing to fuse tables, adding block id and instantanous_penrate_mwd_feet_hour columns
**************************************************************************************************************************************************/ 
with time_zones as (
    select 
    dw_site_code,
    tz_iana 
    from PROD_map.general.site_map
    where load_haul_domain_flag = 'Y'
)
Select 
orig_src_id,
site_code,
dw_bench::varchar as bench,
dw_pushback as pushback,
dw_pattern_name as pattern_name,
original_pattern_name,
drill_cycle_sk,
drill_hole_shift_id,
dw_drill_id as drill_id,
drill_bit_id,
system_operator_id::varchar as system_operator_id,
drill_hole_id,
drill_hole_name,
drill_plan_sk,
drill_hole_status,
is_hole_planned_flag::number(38,0) as is_hole_planned_flag,
(convert_timezone(tz.tz_iana, 'UTC', rcs.start_hole_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as start_hole_ts_utc,
(convert_timezone(tz.tz_iana, 'UTC', rcs.end_hole_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as end_hole_ts_utc,
convert_timezone(tz.tz_iana, start_hole_ts_utc)::timestamp_tz as start_hole_ts_local,
convert_timezone(tz.tz_iana, end_hole_ts_utc)::timestamp_tz as end_hole_ts_local,
dw_hole_duration_seconds::number(38,0) as drill_hole_duration_seconds,
dw_actual_drill_hole_depth_feet as actual_drill_hole_depth_feet,
dw_actual_drill_hole_depth_meters as actual_drill_hole_depth_meters,
gps_accuracy as gps_accuracy,
dw_actual_drill_hole_start_feet_x as actual_drill_hole_start_feet_x,
dw_actual_drill_hole_start_feet_y as actual_drill_hole_start_feet_y,
dw_actual_drill_hole_start_feet_z as actual_drill_hole_start_feet_z,
dw_actual_drill_hole_end_feet_x as actual_drill_hole_end_feet_x,
dw_actual_drill_hole_end_feet_y as actual_drill_hole_end_feet_y,
dw_actual_drill_hole_end_feet_z as actual_drill_hole_end_feet_z,
dw_actual_drill_hole_longitude as actual_drill_hole_longitude,
dw_actual_drill_hole_latitude as actual_drill_hole_latitude,
actual_drill_hole_start_meters_x,
actual_drill_hole_start_meters_y,
actual_drill_hole_start_meters_z,
actual_drill_hole_end_meters_x,
actual_drill_hole_end_meters_y,
actual_drill_hole_end_meters_z,
autodrill_duration_seconds::number(38,0) as autodrill_duration_seconds,
dw_autodrill_usage_pct::number(38,0) as autodrill_usage_pct,
-- dw_avg_hole_penetration_rate_ft_hr, Not available in the data model
dw_drill_hole_penetration_rate_avg_feet_hour as drill_hole_penetration_rate_avg_feet_hour,
(convert_timezone(tz.tz_iana, 'UTC', rcs.operator_login_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as operator_login_ts_utc,
(convert_timezone(tz.tz_iana, 'UTC', rcs.operator_logout_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as operator_logout_ts_utc,
convert_timezone(tz.tz_iana, operator_login_ts_utc)::timestamp_tz as operator_login_ts_local,
convert_timezone(tz.tz_iana, operator_logout_ts_utc)::timestamp_tz as operator_logout_ts_local,
dw_bearing::number(38,1) as bearing,
dw_drill_tower_angle_degree_calculated as drill_tower_angle_degree_calculated,
drill_tower_angle_degree_system,
drill_hole_duplicated_flag::number(38,0) as drill_hole_duplicated_flag,
drill_hole_upside_down_flag::number(38,0) as drill_hole_upside_down_flag ,
drill_hole_start_end_time_invalid_flag::number(38,0) as drill_hole_start_end_time_invalid_flag,
drill_hole_start_end_time_overlap_flag::number(38,0) as drill_hole_start_end_time_overlap_flag,
drill_hole_depth_invalid_flag::number(38,0) as drill_hole_depth_invalid_flag,
drill_hole_angle_invalid_flag::number(38,0) as drill_hole_angle_invalid_flag,
drill_hole_position_invalid_flag::number(38,0) as drill_hole_position_invalid_flag,
dw_time_between_drill_holes_seconds::number(38,0) as time_between_drill_holes_seconds,
air_pressure_psi,
feed_force_newtons,
rotation_torque_nm,
bit_speed_rpm,
water_flow_gpm,
instantanous_penrate_mwd_meters_hour,
dw_instantanous_penrate_mwd_feet_hour as instantanous_penrate_mwd_feet_hour,
dw_drill_hole_off_target_feet as drill_hole_off_target_feet,
dw_drill_hole_off_target_meters as drill_hole_off_target_meters,
dw_drill_hole_horizontal_accuracy_pct::number(38,0) as drill_hole_horizontal_accuracy_pct,
dw_drill_hole_vertical_accuracy_pct::number(38,0) as drill_hole_vertical_accuracy_pct,
dw_overdrill_underdrill_flag::number(38,0) as overdrill_underdrill_flag,
dw_overdrill_underdrill_feet as overdrill_underdrill_feet,
dw_overdrill_underdrill_meters as overdrill_underdrill_meters,
drilling_stops_count::number(38,0) as drilling_stops_count,
dw_drill_hole_redrill_flag::number(38,0) as drill_hole_redrill_flag,
(convert_timezone(tz.tz_iana, 'UTC', rcs.propel_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as propel_start_ts_utc,
(convert_timezone(tz.tz_iana, 'UTC', rcs.propel_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as propel_end_ts_utc,
(convert_timezone(tz.tz_iana, 'UTC', rcs.park_position_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as park_position_start_ts_utc,
(convert_timezone(tz.tz_iana, 'UTC', rcs.park_position_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as park_position_end_ts_utc,
(convert_timezone(tz.tz_iana, 'UTC', rcs.level_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as level_start_ts_utc,
(convert_timezone(tz.tz_iana, 'UTC', rcs.level_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as level_end_ts_utc,
(convert_timezone(tz.tz_iana, 'UTC', rcs.drill_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as drill_start_ts_utc,
(convert_timezone(tz.tz_iana, 'UTC', rcs.drill_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as drill_end_ts_utc,
(convert_timezone(tz.tz_iana, 'UTC', rcs.retract_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as retract_start_ts_utc,
(convert_timezone(tz.tz_iana, 'UTC', rcs.retract_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as retract_end_ts_utc,
convert_timezone(tz.tz_iana, propel_start_ts_utc)::timestamp_tz as propel_start_ts_local,
convert_timezone(tz.tz_iana, propel_end_ts_utc)::timestamp_tz as propel_end_ts_local,
convert_timezone(tz.tz_iana, park_position_start_ts_utc)::timestamp_tz as park_position_start_ts_local,
convert_timezone(tz.tz_iana, park_position_end_ts_utc)::timestamp_tz as park_position_end_ts_local,
convert_timezone(tz.tz_iana, level_start_ts_utc)::timestamp_tz as level_start_ts_local,
convert_timezone(tz.tz_iana, level_end_ts_utc)::timestamp_tz as level_end_ts_local,
convert_timezone(tz.tz_iana, drill_start_ts_utc)::timestamp_tz as drill_start_ts_local,
convert_timezone(tz.tz_iana, drill_end_ts_utc)::timestamp_tz as drill_end_ts_local,
convert_timezone(tz.tz_iana, retract_start_ts_utc)::timestamp_tz as retract_start_ts_local,
convert_timezone(tz.tz_iana, retract_end_ts_utc)::timestamp_tz as retract_end_ts_local,
propel_duration,
park_position_duration,
level_duration,
drill_duration,
retract_duration,
system_drill_state_duration_seconds::number(38,0) as system_drill_state_duration_seconds,
system_setup_state_duration_seconds::number(38,0) as system_setup_state_duration_seconds,
system_auto_level_duration_seconds::number(38,0)::number(38,0) as system_auto_level_duration_seconds,
system_auto_delevel_duration_seconds::number(38,0) as system_auto_delevel_duration_seconds,
plan_creation_ts_local::timestamp_tz as plan_creation_ts_local, -- Added this column because all other ts column showing 1984 or old data 
system_version,
actual_mcf_block_id,
design_mcf_block_id,
dw_load_ts,
dw_modify_ts
from PROD_target.surfacemanager.rcs_drill_cycle_dt rcs
inner join time_zones tz
on rcs.site_code = tz.dw_site_code
union all
select
orig_src_id,
site_code,
dw_bench::varchar as bench,
dw_pushback as pushback,
dw_pattern_name as patter_name,
original_pattern_name,
drill_cycle_sk,
drill_hole_shift_id,
dw_drill_id as drill_id,
drill_bit_id,
system_operator_id::varchar as system_operator_id, -- Operator id as name / id in the same column
drill_hole_id::varchar as drill_hole_id, -- Its coming as a number in caes so casted to varchar to match RCS
drill_hole_name,
drill_plan_sk,
drill_hole_status,
dw_is_hole_planned_flag::number(38,0) as is_hole_planned_flag,
(dw_start_hole_ts_utc || '+0000')::timestamp_tz as start_hole_ts_utc,
(dw_end_hole_ts_utc || '+0000')::timestamp_tz as end_hole_ts_utc,
convert_timezone(tz.tz_iana, dw_start_hole_ts_utc)::timestamp_tz as start_hole_ts_local,
convert_timezone(tz.tz_iana, dw_end_hole_ts_utc)::timestamp_tz as end_hole_ts_local,
dw_drill_hole_duration_seconds::number(38,0) as drill_hole_duration_seconds,
dw_actual_drill_hole_depth_feet as actual_drill_hole_depth_feet,
actual_drill_hole_depth_meters,
gps_accuracy as gps_accuracy,
dw_actual_drill_hole_start_feet_x as actual_drill_hole_start_feet_x,
dw_actual_drill_hole_start_feet_y as actual_drill_hole_start_feet_y,
dw_actual_drill_hole_start_feet_z as actual_drill_hole_start_feet_z,
dw_actual_drill_hole_end_feet_x as actual_drill_hole_end_feet_x,
dw_actual_drill_hole_end_feet_y as actual_drill_hole_end_feet_y,
dw_actual_drill_hole_end_feet_z as actual_drill_hole_end_feet_z,
dw_actual_drill_hole_longitude as actual_drill_hole_longitude,
dw_actual_drill_hole_latitude as actual_drill_hole_latitude,
actual_drill_hole_start_meters_x,
actual_drill_hole_start_meters_y,
actual_drill_hole_start_meters_z,
actual_drill_hole_end_meters_x,
actual_drill_hole_end_meters_y,
actual_drill_hole_end_meters_z,
autodrill_duration_seconds::number(38,0) as autodrill_duration_seconds,
autodrill_usage_pct::number(38,0) as autodrill_usage_pct,
-- dw_drill_hole_penetration_rate_avg_feet_hour_feet_hour as ,
dw_drill_hole_penetration_rate_avg_feet_hour as drill_hole_penetration_rate_avg_feet_hour,
(operator_login_ts_utc || '+0000')::timestamp_tz as operator_login_ts_utc,
(operator_logout_ts_utc || '+0000')::timestamp_tz as operator_logout_ts_utc,
convert_timezone(tz.tz_iana, operator_login_ts_utc)::timestamp_tz as operator_login_ts_local,
convert_timezone(tz.tz_iana, operator_logout_ts_utc)::timestamp_tz as operator_logout_ts_local,
bearing::number(38,1) as bearing,
drill_tower_angle_degree_calculated,
drill_tower_angle_degree_system,
drill_hole_duplicated_flag::number(38,0)::number(38,0) as drill_hole_duplicated_flag,
drill_hole_upside_down_flag::number(38,0) as drill_hole_upside_down_flag,
drill_hole_start_end_time_invalid_flag::number(38,0) as drill_hole_start_end_time_invalid_flag,
drill_hole_start_end_time_overlap_flag::number(38,0) as drill_hole_start_end_time_overlap_flag,
drill_hole_depth_invalid_flag::number(38,0) as drill_hole_depth_invalid_flag,
drill_hole_angle_invalid_flag::number(38,0) as drill_hole_angle_invalid_flag,
drill_hole_position_invalid_flag::number(38,0) as drill_hole_position_invalid_flag,
dw_time_between_drill_holes_seconds::number(38,0) as time_between_drill_holes_seconds,
air_pressure_psi,
feed_force_newtons,
rotation_torque_nm,
bit_speed_rpm,
water_flow_gpm,
instantanous_penrate_mwd_meters_hour,
instantanous_penrate_mwd_feet_hour,
drill_hole_off_target_feet,
drill_hole_off_target_meters,
drill_hole_horizontal_accuracy_pct::number(38,0) as drill_hole_horizontal_accuracy_pct,
drill_hole_vertical_accuracy_pct::number(38,0) as drill_hole_vertical_accuracy_pct,
overdrill_underdrill_flag::number(38,0) as overdrill_underdrill_flag,
overdrill_underdrill_feet,
overdrill_underdrill_meters,
drilling_stops_count::number(38,0) as drilling_stops_count,
dw_drill_hole_redrill_flag::number(38,0) as drill_hole_redrill_flag,
(propel_start_ts_utc || '+0000')::timestamp_tz as propel_start_ts_utc,
(propel_end_ts_utc || '+0000')::timestamp_tz as propel_end_ts_utc,
(park_position_start_ts_utc || '+0000')::timestamp_tz as park_position_start_ts_utc,
(park_position_end_ts_utc || '+0000')::timestamp_tz as park_position_end_ts_utc,
(level_start_ts_utc || '+0000')::timestamp_tz as level_start_ts_utc,
(level_end_ts_utc || '+0000')::timestamp_tz as level_end_ts_utc,
(drill_start_ts_utc || '+0000')::timestamp_tz as drill_start_ts_utc,
(drill_end_ts_utc || '+0000')::timestamp_tz as drill_end_ts_utc,
(retract_start_ts_utc || '+0000')::timestamp_tz as retract_start_ts_utc,
(retract_end_ts_utc || '+0000')::timestamp_tz as retract_end_ts_utc,
convert_timezone(tz.tz_iana, propel_start_ts_utc)::timestamp_tz as propel_start_ts_local,
convert_timezone(tz.tz_iana, propel_end_ts_utc)::timestamp_tz as propel_end_ts_local,
convert_timezone(tz.tz_iana, park_position_start_ts_utc)::timestamp_tz as position_start_ts_local,
convert_timezone(tz.tz_iana, park_position_end_ts_utc)::timestamp_tz as position_end_ts_local,
convert_timezone(tz.tz_iana, level_start_ts_utc)::timestamp_tz as level_start_ts_local,
convert_timezone(tz.tz_iana, level_end_ts_utc)::timestamp_tz as level_end_ts_local,
convert_timezone(tz.tz_iana, drill_start_ts_utc)::timestamp_tz as drill_start_ts_local,
convert_timezone(tz.tz_iana, drill_end_ts_utc)::timestamp_tz as drill_end_ts_local,
convert_timezone(tz.tz_iana, retract_start_ts_utc)::timestamp_tz as retract_start_ts_local,
convert_timezone(tz.tz_iana, retract_end_ts_utc)::timestamp_tz as retract_end_ts_local,
propel_duration,
park_position_duration,
level_duration,
drill_duration,
retract_duration,
system_drill_state_duration_seconds::number(38,0) as system_drill_state_duration_seconds,
system_setup_state_duration_seconds::number(38,0) as system_setup_state_duration_seconds,
system_auto_level_duration_seconds::number(38,0) as system_auto_level_duration_seconds,
system_auto_delevel_duration_seconds::number(38,0) as system_auto_delevel_duration_seconds,
plan_creation_ts_local::timestamp_tz as plan_creation_ts_local, -- Added this column because all other ts column showing 1984 or old data 
system_version,
actual_mcf_block_id,
design_mcf_block_id,
dw_load_ts,
dw_modify_ts
from PROD_target.catterrain.caes_drill_cycle_dt caes
inner join time_zones tz
on caes.site_code = tz.dw_site_code;
```

Owner action (for stream-on-view enablement):
- If this Dynamic Table uses REFRESH_MODE='FULL', Snowflake requires an IMMUTABLE constraint to support change tracking/streams downstream.
- Use the DDL above as the exact starting point; add an IMMUTABLE constraint only if the DT query is deterministic.
