{
  "dynamic_tables": [
    {
      "ddl": "create or replace dynamic table DRILLBLAST_DRILL_CYCLE_DT(\n\tORIG_SRC_ID,\n\tSITE_CODE,\n\tBENCH,\n\tPUSHBACK,\n\tPATTERN_NAME,\n\tORIGINAL_PATTERN_NAME,\n\tDRILL_CYCLE_SK,\n\tDRILL_HOLE_SHIFT_ID,\n\tDRILL_ID,\n\tDRILL_BIT_ID,\n\tSYSTEM_OPERATOR_ID,\n\tDRILL_HOLE_ID,\n\tDRILL_HOLE_NAME,\n\tDRILL_PLAN_SK,\n\tDRILL_HOLE_STATUS,\n\tIS_HOLE_PLANNED_FLAG,\n\tSTART_HOLE_TS_UTC,\n\tEND_HOLE_TS_UTC,\n\tSTART_HOLE_TS_LOCAL,\n\tEND_HOLE_TS_LOCAL,\n\tDRILL_HOLE_DURATION_SECONDS,\n\tACTUAL_DRILL_HOLE_DEPTH_FEET,\n\tACTUAL_DRILL_HOLE_DEPTH_METERS,\n\tGPS_ACCURACY,\n\tACTUAL_DRILL_HOLE_START_FEET_X,\n\tACTUAL_DRILL_HOLE_START_FEET_Y,\n\tACTUAL_DRILL_HOLE_START_FEET_Z,\n\tACTUAL_DRILL_HOLE_END_FEET_X,\n\tACTUAL_DRILL_HOLE_END_FEET_Y,\n\tACTUAL_DRILL_HOLE_END_FEET_Z,\n\tACTUAL_DRILL_HOLE_LONGITUDE,\n\tACTUAL_DRILL_HOLE_LATITUDE,\n\tACTUAL_DRILL_HOLE_START_METERS_X,\n\tACTUAL_DRILL_HOLE_START_METERS_Y,\n\tACTUAL_DRILL_HOLE_START_METERS_Z,\n\tACTUAL_DRILL_HOLE_END_METERS_X,\n\tACTUAL_DRILL_HOLE_END_METERS_Y,\n\tACTUAL_DRILL_HOLE_END_METERS_Z,\n\tAUTODRILL_DURATION_SECONDS,\n\tAUTODRILL_USAGE_PCT,\n\tDRILL_HOLE_PENETRATION_RATE_AVG_FEET_HOUR,\n\tOPERATOR_LOGIN_TS_UTC,\n\tOPERATOR_LOGOUT_TS_UTC,\n\tOPERATOR_LOGIN_TS_LOCAL,\n\tOPERATOR_LOGOUT_TS_LOCAL,\n\tBEARING,\n\tDRILL_TOWER_ANGLE_DEGREE_CALCULATED,\n\tDRILL_TOWER_ANGLE_DEGREE_SYSTEM,\n\tDRILL_HOLE_DUPLICATED_FLAG,\n\tDRILL_HOLE_UPSIDE_DOWN_FLAG,\n\tDRILL_HOLE_START_END_TIME_INVALID_FLAG,\n\tDRILL_HOLE_START_END_TIME_OVERLAP_FLAG,\n\tDRILL_HOLE_DEPTH_INVALID_FLAG,\n\tDRILL_HOLE_ANGLE_INVALID_FLAG,\n\tDRILL_HOLE_POSITION_INVALID_FLAG,\n\tTIME_BETWEEN_DRILL_HOLES_SECONDS,\n\tAIR_PRESSURE_PSI,\n\tFEED_FORCE_NEWTONS,\n\tROTATION_TORQUE_NM,\n\tBIT_SPEED_RPM,\n\tWATER_FLOW_GPM,\n\tINSTANTANOUS_PENRATE_MWD_METERS_HOUR,\n\tINSTANTANOUS_PENRATE_MWD_FEET_HOUR,\n\tDRILL_HOLE_OFF_TARGET_FEET,\n\tDRILL_HOLE_OFF_TARGET_METERS,\n\tDRILL_HOLE_HORIZONTAL_ACCURACY_PCT,\n\tDRILL_HOLE_VERTICAL_ACCURACY_PCT,\n\tOVERDRILL_UNDERDRILL_FLAG,\n\tOVERDRILL_UNDERDRILL_FEET,\n\tOVERDRILL_UNDERDRILL_METERS,\n\tDRILLING_STOPS_COUNT,\n\tDRILL_HOLE_REDRILL_FLAG,\n\tPROPEL_START_TS_UTC,\n\tPROPEL_END_TS_UTC,\n\tPARK_POSITION_START_TS_UTC,\n\tPARK_POSITION_END_TS_UTC,\n\tLEVEL_START_TS_UTC,\n\tLEVEL_END_TS_UTC,\n\tDRILL_START_TS_UTC,\n\tDRILL_END_TS_UTC,\n\tRETRACT_START_TS_UTC,\n\tRETRACT_END_TS_UTC,\n\tPROPEL_START_TS_LOCAL,\n\tPROPEL_END_TS_LOCAL,\n\tPARK_POSITION_START_TS_LOCAL,\n\tPARK_POSITION_END_TS_LOCAL,\n\tLEVEL_START_TS_LOCAL,\n\tLEVEL_END_TS_LOCAL,\n\tDRILL_START_TS_LOCAL,\n\tDRILL_END_TS_LOCAL,\n\tRETRACT_START_TS_LOCAL,\n\tRETRACT_END_TS_LOCAL,\n\tPROPEL_DURATION,\n\tPARK_POSITION_DURATION,\n\tLEVEL_DURATION,\n\tDRILL_DURATION,\n\tRETRACT_DURATION,\n\tSYSTEM_DRILL_STATE_DURATION_SECONDS,\n\tSYSTEM_SETUP_STATE_DURATION_SECONDS,\n\tSYSTEM_AUTO_LEVEL_DURATION_SECONDS,\n\tSYSTEM_AUTO_DELEVEL_DURATION_SECONDS,\n\tPLAN_CREATION_TS_LOCAL,\n\tSYSTEM_VERSION,\n\tACTUAL_MCF_BLOCK_ID,\n\tDESIGN_MCF_BLOCK_ID,\n\tDW_LOAD_TS,\n\tDW_MODIFY_TS\n) target_lag = '5 minutes' refresh_mode = AUTO initialize = ON_CREATE warehouse = WH_BATCH_DE\n as\n/***************************************************************************************************************************************************\n* TABLE NAME: PROD_TARGET.COLLECTIONS.DRILLBLAST_DRILL_CYCLE_DT\n* PURPOSE:  This dynamic table Centralizes information about drilling cycles from CAT Terrain And Surface manager source systems.\n* Note:\t\tThis designs overlap with other source systems generting cycles at the same time for the same holes. Hence adding system version as part of PK.\n* SITE: \t\n* Usage:  \tSelect * from PROD_TARGET.COLLECTIONS.DRILLBLAST_DRILL_CYCLE_DT limit 10;\n* Primary Key :  orig_src_id,site_code,  drill_hole_shift_id, system_version , dw_drill_id, drill_hole_id\n* CREATE/CHANGE LOG :  \n* DATE             MOD BY               GCC                                                 DESC\n*--------------------------------------------------------------------------------------------------------------------------------------------------\n* 2025-08-01    MURALI NAIDU           Drill Productivity Data Model             Initial version \n* 2025-08-26    MURALI NAIDU           Drill Productivity Data Model             Repointng to PROD_general.target ( fuse is not able to handle archival process now, will repoint to surfacemanager once fuse able to handle archival data)\n* 2025-10-27    Murali Naidu           Drill Productivity Data Model              Adding Dimensional columns to the drill cycle view\n* 2025-10-27    Murali Naidu           Drill Productivity Data Model              Renaming columns as per ethan's request\n* 2025-11-24    Murali Naidu           Drill Productivity Data Model              Repointing to fuse tables, adding block id and instantanous_penrate_mwd_feet_hour columns\n**************************************************************************************************************************************************/ \nwith time_zones as (\n    select \n    dw_site_code,\n    tz_iana \n    from PROD_map.general.site_map\n    where load_haul_domain_flag = 'Y'\n)\nSelect \norig_src_id,\nsite_code,\ndw_bench::varchar as bench,\ndw_pushback as pushback,\ndw_pattern_name as pattern_name,\noriginal_pattern_name,\ndrill_cycle_sk,\ndrill_hole_shift_id,\ndw_drill_id as drill_id,\ndrill_bit_id,\nsystem_operator_id::varchar as system_operator_id,\ndrill_hole_id,\ndrill_hole_name,\ndrill_plan_sk,\ndrill_hole_status,\nis_hole_planned_flag::number(38,0) as is_hole_planned_flag,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.start_hole_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as start_hole_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.end_hole_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as end_hole_ts_utc,\nconvert_timezone(tz.tz_iana, start_hole_ts_utc)::timestamp_tz as start_hole_ts_local,\nconvert_timezone(tz.tz_iana, end_hole_ts_utc)::timestamp_tz as end_hole_ts_local,\ndw_hole_duration_seconds::number(38,0) as drill_hole_duration_seconds,\ndw_actual_drill_hole_depth_feet as actual_drill_hole_depth_feet,\ndw_actual_drill_hole_depth_meters as actual_drill_hole_depth_meters,\ngps_accuracy as gps_accuracy,\ndw_actual_drill_hole_start_feet_x as actual_drill_hole_start_feet_x,\ndw_actual_drill_hole_start_feet_y as actual_drill_hole_start_feet_y,\ndw_actual_drill_hole_start_feet_z as actual_drill_hole_start_feet_z,\ndw_actual_drill_hole_end_feet_x as actual_drill_hole_end_feet_x,\ndw_actual_drill_hole_end_feet_y as actual_drill_hole_end_feet_y,\ndw_actual_drill_hole_end_feet_z as actual_drill_hole_end_feet_z,\ndw_actual_drill_hole_longitude as actual_drill_hole_longitude,\ndw_actual_drill_hole_latitude as actual_drill_hole_latitude,\nactual_drill_hole_start_meters_x,\nactual_drill_hole_start_meters_y,\nactual_drill_hole_start_meters_z,\nactual_drill_hole_end_meters_x,\nactual_drill_hole_end_meters_y,\nactual_drill_hole_end_meters_z,\nautodrill_duration_seconds::number(38,0) as autodrill_duration_seconds,\ndw_autodrill_usage_pct::number(38,0) as autodrill_usage_pct,\n-- dw_avg_hole_penetration_rate_ft_hr, Not available in the data model\ndw_drill_hole_penetration_rate_avg_feet_hour as drill_hole_penetration_rate_avg_feet_hour,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.operator_login_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as operator_login_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.operator_logout_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as operator_logout_ts_utc,\nconvert_timezone(tz.tz_iana, operator_login_ts_utc)::timestamp_tz as operator_login_ts_local,\nconvert_timezone(tz.tz_iana, operator_logout_ts_utc)::timestamp_tz as operator_logout_ts_local,\ndw_bearing::number(38,1) as bearing,\ndw_drill_tower_angle_degree_calculated as drill_tower_angle_degree_calculated,\ndrill_tower_angle_degree_system,\ndrill_hole_duplicated_flag::number(38,0) as drill_hole_duplicated_flag,\ndrill_hole_upside_down_flag::number(38,0) as drill_hole_upside_down_flag ,\ndrill_hole_start_end_time_invalid_flag::number(38,0) as drill_hole_start_end_time_invalid_flag,\ndrill_hole_start_end_time_overlap_flag::number(38,0) as drill_hole_start_end_time_overlap_flag,\ndrill_hole_depth_invalid_flag::number(38,0) as drill_hole_depth_invalid_flag,\ndrill_hole_angle_invalid_flag::number(38,0) as drill_hole_angle_invalid_flag,\ndrill_hole_position_invalid_flag::number(38,0) as drill_hole_position_invalid_flag,\ndw_time_between_drill_holes_seconds::number(38,0) as time_between_drill_holes_seconds,\nair_pressure_psi,\nfeed_force_newtons,\nrotation_torque_nm,\nbit_speed_rpm,\nwater_flow_gpm,\ninstantanous_penrate_mwd_meters_hour,\ndw_instantanous_penrate_mwd_feet_hour as instantanous_penrate_mwd_feet_hour,\ndw_drill_hole_off_target_feet as drill_hole_off_target_feet,\ndw_drill_hole_off_target_meters as drill_hole_off_target_meters,\ndw_drill_hole_horizontal_accuracy_pct::number(38,0) as drill_hole_horizontal_accuracy_pct,\ndw_drill_hole_vertical_accuracy_pct::number(38,0) as drill_hole_vertical_accuracy_pct,\ndw_overdrill_underdrill_flag::number(38,0) as overdrill_underdrill_flag,\ndw_overdrill_underdrill_feet as overdrill_underdrill_feet,\ndw_overdrill_underdrill_meters as overdrill_underdrill_meters,\ndrilling_stops_count::number(38,0) as drilling_stops_count,\ndw_drill_hole_redrill_flag::number(38,0) as drill_hole_redrill_flag,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.propel_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as propel_start_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.propel_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as propel_end_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.park_position_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as park_position_start_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.park_position_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as park_position_end_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.level_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as level_start_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.level_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as level_end_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.drill_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as drill_start_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.drill_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as drill_end_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.retract_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as retract_start_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.retract_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as retract_end_ts_utc,\nconvert_timezone(tz.tz_iana, propel_start_ts_utc)::timestamp_tz as propel_start_ts_local,\nconvert_timezone(tz.tz_iana, propel_end_ts_utc)::timestamp_tz as propel_end_ts_local,\nconvert_timezone(tz.tz_iana, park_position_start_ts_utc)::timestamp_tz as park_position_start_ts_local,\nconvert_timezone(tz.tz_iana, park_position_end_ts_utc)::timestamp_tz as park_position_end_ts_local,\nconvert_timezone(tz.tz_iana, level_start_ts_utc)::timestamp_tz as level_start_ts_local,\nconvert_timezone(tz.tz_iana, level_end_ts_utc)::timestamp_tz as level_end_ts_local,\nconvert_timezone(tz.tz_iana, drill_start_ts_utc)::timestamp_tz as drill_start_ts_local,\nconvert_timezone(tz.tz_iana, drill_end_ts_utc)::timestamp_tz as drill_end_ts_local,\nconvert_timezone(tz.tz_iana, retract_start_ts_utc)::timestamp_tz as retract_start_ts_local,\nconvert_timezone(tz.tz_iana, retract_end_ts_utc)::timestamp_tz as retract_end_ts_local,\npropel_duration,\npark_position_duration,\nlevel_duration,\ndrill_duration,\nretract_duration,\nsystem_drill_state_duration_seconds::number(38,0) as system_drill_state_duration_seconds,\nsystem_setup_state_duration_seconds::number(38,0) as system_setup_state_duration_seconds,\nsystem_auto_level_duration_seconds::number(38,0)::number(38,0) as system_auto_level_duration_seconds,\nsystem_auto_delevel_duration_seconds::number(38,0) as system_auto_delevel_duration_seconds,\nplan_creation_ts_local::timestamp_tz as plan_creation_ts_local, -- Added this column because all other ts column showing 1984 or old data \nsystem_version,\nactual_mcf_block_id,\ndesign_mcf_block_id,\ndw_load_ts,\ndw_modify_ts\nfrom PROD_target.surfacemanager.rcs_drill_cycle_dt rcs\ninner join time_zones tz\non rcs.site_code = tz.dw_site_code\nunion all\nselect\norig_src_id,\nsite_code,\ndw_bench::varchar as bench,\ndw_pushback as pushback,\ndw_pattern_name as patter_name,\noriginal_pattern_name,\ndrill_cycle_sk,\ndrill_hole_shift_id,\ndw_drill_id as drill_id,\ndrill_bit_id,\nsystem_operator_id::varchar as system_operator_id, -- Operator id as name / id in the same column\ndrill_hole_id::varchar as drill_hole_id, -- Its coming as a number in caes so casted to varchar to match RCS\ndrill_hole_name,\ndrill_plan_sk,\ndrill_hole_status,\ndw_is_hole_planned_flag::number(38,0) as is_hole_planned_flag,\n(dw_start_hole_ts_utc || '+0000')::timestamp_tz as start_hole_ts_utc,\n(dw_end_hole_ts_utc || '+0000')::timestamp_tz as end_hole_ts_utc,\nconvert_timezone(tz.tz_iana, dw_start_hole_ts_utc)::timestamp_tz as start_hole_ts_local,\nconvert_timezone(tz.tz_iana, dw_end_hole_ts_utc)::timestamp_tz as end_hole_ts_local,\ndw_drill_hole_duration_seconds::number(38,0) as drill_hole_duration_seconds,\ndw_actual_drill_hole_depth_feet as actual_drill_hole_depth_feet,\nactual_drill_hole_depth_meters,\ngps_accuracy as gps_accuracy,\ndw_actual_drill_hole_start_feet_x as actual_drill_hole_start_feet_x,\ndw_actual_drill_hole_start_feet_y as actual_drill_hole_start_feet_y,\ndw_actual_drill_hole_start_feet_z as actual_drill_hole_start_feet_z,\ndw_actual_drill_hole_end_feet_x as actual_drill_hole_end_feet_x,\ndw_actual_drill_hole_end_feet_y as actual_drill_hole_end_feet_y,\ndw_actual_drill_hole_end_feet_z as actual_drill_hole_end_feet_z,\ndw_actual_drill_hole_longitude as actual_drill_hole_longitude,\ndw_actual_drill_hole_latitude as actual_drill_hole_latitude,\nactual_drill_hole_start_meters_x,\nactual_drill_hole_start_meters_y,\nactual_drill_hole_start_meters_z,\nactual_drill_hole_end_meters_x,\nactual_drill_hole_end_meters_y,\nactual_drill_hole_end_meters_z,\nautodrill_duration_seconds::number(38,0) as autodrill_duration_seconds,\nautodrill_usage_pct::number(38,0) as autodrill_usage_pct,\n-- dw_drill_hole_penetration_rate_avg_feet_hour_feet_hour as ,\ndw_drill_hole_penetration_rate_avg_feet_hour as drill_hole_penetration_rate_avg_feet_hour,\n(operator_login_ts_utc || '+0000')::timestamp_tz as operator_login_ts_utc,\n(operator_logout_ts_utc || '+0000')::timestamp_tz as operator_logout_ts_utc,\nconvert_timezone(tz.tz_iana, operator_login_ts_utc)::timestamp_tz as operator_login_ts_local,\nconvert_timezone(tz.tz_iana, operator_logout_ts_utc)::timestamp_tz as operator_logout_ts_local,\nbearing::number(38,1) as bearing,\ndrill_tower_angle_degree_calculated,\ndrill_tower_angle_degree_system,\ndrill_hole_duplicated_flag::number(38,0)::number(38,0) as drill_hole_duplicated_flag,\ndrill_hole_upside_down_flag::number(38,0) as drill_hole_upside_down_flag,\ndrill_hole_start_end_time_invalid_flag::number(38,0) as drill_hole_start_end_time_invalid_flag,\ndrill_hole_start_end_time_overlap_flag::number(38,0) as drill_hole_start_end_time_overlap_flag,\ndrill_hole_depth_invalid_flag::number(38,0) as drill_hole_depth_invalid_flag,\ndrill_hole_angle_invalid_flag::number(38,0) as drill_hole_angle_invalid_flag,\ndrill_hole_position_invalid_flag::number(38,0) as drill_hole_position_invalid_flag,\ndw_time_between_drill_holes_seconds::number(38,0) as time_between_drill_holes_seconds,\nair_pressure_psi,\nfeed_force_newtons,\nrotation_torque_nm,\nbit_speed_rpm,\nwater_flow_gpm,\ninstantanous_penrate_mwd_meters_hour,\ninstantanous_penrate_mwd_feet_hour,\ndrill_hole_off_target_feet,\ndrill_hole_off_target_meters,\ndrill_hole_horizontal_accuracy_pct::number(38,0) as drill_hole_horizontal_accuracy_pct,\ndrill_hole_vertical_accuracy_pct::number(38,0) as drill_hole_vertical_accuracy_pct,\noverdrill_underdrill_flag::number(38,0) as overdrill_underdrill_flag,\noverdrill_underdrill_feet,\noverdrill_underdrill_meters,\ndrilling_stops_count::number(38,0) as drilling_stops_count,\ndw_drill_hole_redrill_flag::number(38,0) as drill_hole_redrill_flag,\n(propel_start_ts_utc || '+0000')::timestamp_tz as propel_start_ts_utc,\n(propel_end_ts_utc || '+0000')::timestamp_tz as propel_end_ts_utc,\n(park_position_start_ts_utc || '+0000')::timestamp_tz as park_position_start_ts_utc,\n(park_position_end_ts_utc || '+0000')::timestamp_tz as park_position_end_ts_utc,\n(level_start_ts_utc || '+0000')::timestamp_tz as level_start_ts_utc,\n(level_end_ts_utc || '+0000')::timestamp_tz as level_end_ts_utc,\n(drill_start_ts_utc || '+0000')::timestamp_tz as drill_start_ts_utc,\n(drill_end_ts_utc || '+0000')::timestamp_tz as drill_end_ts_utc,\n(retract_start_ts_utc || '+0000')::timestamp_tz as retract_start_ts_utc,\n(retract_end_ts_utc || '+0000')::timestamp_tz as retract_end_ts_utc,\nconvert_timezone(tz.tz_iana, propel_start_ts_utc)::timestamp_tz as propel_start_ts_local,\nconvert_timezone(tz.tz_iana, propel_end_ts_utc)::timestamp_tz as propel_end_ts_local,\nconvert_timezone(tz.tz_iana, park_position_start_ts_utc)::timestamp_tz as position_start_ts_local,\nconvert_timezone(tz.tz_iana, park_position_end_ts_utc)::timestamp_tz as position_end_ts_local,\nconvert_timezone(tz.tz_iana, level_start_ts_utc)::timestamp_tz as level_start_ts_local,\nconvert_timezone(tz.tz_iana, level_end_ts_utc)::timestamp_tz as level_end_ts_local,\nconvert_timezone(tz.tz_iana, drill_start_ts_utc)::timestamp_tz as drill_start_ts_local,\nconvert_timezone(tz.tz_iana, drill_end_ts_utc)::timestamp_tz as drill_end_ts_local,\nconvert_timezone(tz.tz_iana, retract_start_ts_utc)::timestamp_tz as retract_start_ts_local,\nconvert_timezone(tz.tz_iana, retract_end_ts_utc)::timestamp_tz as retract_end_ts_local,\npropel_duration,\npark_position_duration,\nlevel_duration,\ndrill_duration,\nretract_duration,\nsystem_drill_state_duration_seconds::number(38,0) as system_drill_state_duration_seconds,\nsystem_setup_state_duration_seconds::number(38,0) as system_setup_state_duration_seconds,\nsystem_auto_level_duration_seconds::number(38,0) as system_auto_level_duration_seconds,\nsystem_auto_delevel_duration_seconds::number(38,0) as system_auto_delevel_duration_seconds,\nplan_creation_ts_local::timestamp_tz as plan_creation_ts_local, -- Added this column because all other ts column showing 1984 or old data \nsystem_version,\nactual_mcf_block_id,\ndesign_mcf_block_id,\ndw_load_ts,\ndw_modify_ts\nfrom PROD_target.catterrain.caes_drill_cycle_dt caes\ninner join time_zones tz\non caes.site_code = tz.dw_site_code;",
      "describe": null,
      "domain": "DYNAMIC TABLE",
      "fqn": "PROD_TARGET.COLLECTIONS.DRILLBLAST_DRILL_CYCLE_DT",
      "path_from_root": [
        {
          "db": "PROD_WG",
          "domain": "VIEW",
          "name": "DRILL_CYCLE",
          "schema": "DRILL_BLAST"
        },
        {
          "db": "PROD_TARGET",
          "domain": "VIEW",
          "name": "DRILLBLAST_DRILL_CYCLE_V",
          "schema": "COLLECTIONS"
        },
        {
          "db": "PROD_TARGET",
          "domain": "DYNAMIC TABLE",
          "name": "DRILLBLAST_DRILL_CYCLE_DT",
          "schema": "COLLECTIONS"
        }
      ],
      "show": {
        "automatic_clustering": "OFF",
        "bytes": 10407936,
        "cluster_by": "",
        "comment": "",
        "created_on": "2025-12-08T12:05:52.883000-07:00",
        "data_timestamp": "2026-01-06T13:10:19.989000-07:00",
        "database_name": "PROD_TARGET",
        "immutable_where": null,
        "insert_only_inputs": "false",
        "is_clone": "false",
        "is_iceberg": "false",
        "is_replica": "false",
        "last_suspended_on": null,
        "name": "DRILLBLAST_DRILL_CYCLE_DT",
        "owner": "FCX_ADMIN_PROD",
        "owner_role_type": "ROLE",
        "refresh_mode": "FULL",
        "refresh_mode_reason": "Input Dynamic Tables are FULL refresh without IMMUTABLE WHERE specified: [RCS_DRILL_CYCLE_DT, CAES_DRILL_CYCLE_DT]",
        "rows": 41186,
        "scheduling_state": "ACTIVE",
        "schema_name": "COLLECTIONS",
        "target_lag": "5 minutes",
        "text": "CREATE OR REPLACE dynamic table PROD_TARGET.COLLECTIONS.DRILLBLAST_DRILL_CYCLE_DT lag = '5 minutes' refresh_mode = 'AUTO' initialize = 'ON_CREATE' warehouse = WH_BATCH_DE as\n/***************************************************************************************************************************************************\n* TABLE NAME: PROD_TARGET.COLLECTIONS.DRILLBLAST_DRILL_CYCLE_DT\n* PURPOSE:  This dynamic table Centralizes information about drilling cycles from CAT Terrain And Surface manager source systems.\n* Note:\t\tThis designs overlap with other source systems generting cycles at the same time for the same holes. Hence adding system version as part of PK.\n* SITE: \t\n* Usage:  \tSelect * from PROD_TARGET.COLLECTIONS.DRILLBLAST_DRILL_CYCLE_DT limit 10;\n* Primary Key :  orig_src_id,site_code,  drill_hole_shift_id, system_version , dw_drill_id, drill_hole_id\n* CREATE/CHANGE LOG :  \n* DATE             MOD BY               GCC                                                 DESC\n*--------------------------------------------------------------------------------------------------------------------------------------------------\n* 2025-08-01    MURALI NAIDU           Drill Productivity Data Model             Initial version \n* 2025-08-26    MURALI NAIDU           Drill Productivity Data Model             Repointng to PROD_general.target ( fuse is not able to handle archival process now, will repoint to surfacemanager once fuse able to handle archival data)\n* 2025-10-27    Murali Naidu           Drill Productivity Data Model              Adding Dimensional columns to the drill cycle view\n* 2025-10-27    Murali Naidu           Drill Productivity Data Model              Renaming columns as per ethan's request\n* 2025-11-24    Murali Naidu           Drill Productivity Data Model              Repointing to fuse tables, adding block id and instantanous_penrate_mwd_feet_hour columns\n**************************************************************************************************************************************************/ \nwith time_zones as (\n    select \n    dw_site_code,\n    tz_iana \n    from PROD_map.general.site_map\n    where load_haul_domain_flag = 'Y'\n)\nSelect \norig_src_id,\nsite_code,\ndw_bench::varchar as bench,\ndw_pushback as pushback,\ndw_pattern_name as pattern_name,\noriginal_pattern_name,\ndrill_cycle_sk,\ndrill_hole_shift_id,\ndw_drill_id as drill_id,\ndrill_bit_id,\nsystem_operator_id::varchar as system_operator_id,\ndrill_hole_id,\ndrill_hole_name,\ndrill_plan_sk,\ndrill_hole_status,\nis_hole_planned_flag::number(38,0) as is_hole_planned_flag,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.start_hole_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as start_hole_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.end_hole_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as end_hole_ts_utc,\nconvert_timezone(tz.tz_iana, start_hole_ts_utc)::timestamp_tz as start_hole_ts_local,\nconvert_timezone(tz.tz_iana, end_hole_ts_utc)::timestamp_tz as end_hole_ts_local,\ndw_hole_duration_seconds::number(38,0) as drill_hole_duration_seconds,\ndw_actual_drill_hole_depth_feet as actual_drill_hole_depth_feet,\ndw_actual_drill_hole_depth_meters as actual_drill_hole_depth_meters,\ngps_accuracy as gps_accuracy,\ndw_actual_drill_hole_start_feet_x as actual_drill_hole_start_feet_x,\ndw_actual_drill_hole_start_feet_y as actual_drill_hole_start_feet_y,\ndw_actual_drill_hole_start_feet_z as actual_drill_hole_start_feet_z,\ndw_actual_drill_hole_end_feet_x as actual_drill_hole_end_feet_x,\ndw_actual_drill_hole_end_feet_y as actual_drill_hole_end_feet_y,\ndw_actual_drill_hole_end_feet_z as actual_drill_hole_end_feet_z,\ndw_actual_drill_hole_longitude as actual_drill_hole_longitude,\ndw_actual_drill_hole_latitude as actual_drill_hole_latitude,\nactual_drill_hole_start_meters_x,\nactual_drill_hole_start_meters_y,\nactual_drill_hole_start_meters_z,\nactual_drill_hole_end_meters_x,\nactual_drill_hole_end_meters_y,\nactual_drill_hole_end_meters_z,\nautodrill_duration_seconds::number(38,0) as autodrill_duration_seconds,\ndw_autodrill_usage_pct::number(38,0) as autodrill_usage_pct,\n-- dw_avg_hole_penetration_rate_ft_hr, Not available in the data model\ndw_drill_hole_penetration_rate_avg_feet_hour as drill_hole_penetration_rate_avg_feet_hour,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.operator_login_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as operator_login_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.operator_logout_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as operator_logout_ts_utc,\nconvert_timezone(tz.tz_iana, operator_login_ts_utc)::timestamp_tz as operator_login_ts_local,\nconvert_timezone(tz.tz_iana, operator_logout_ts_utc)::timestamp_tz as operator_logout_ts_local,\ndw_bearing::number(38,1) as bearing,\ndw_drill_tower_angle_degree_calculated as drill_tower_angle_degree_calculated,\ndrill_tower_angle_degree_system,\ndrill_hole_duplicated_flag::number(38,0) as drill_hole_duplicated_flag,\ndrill_hole_upside_down_flag::number(38,0) as drill_hole_upside_down_flag ,\ndrill_hole_start_end_time_invalid_flag::number(38,0) as drill_hole_start_end_time_invalid_flag,\ndrill_hole_start_end_time_overlap_flag::number(38,0) as drill_hole_start_end_time_overlap_flag,\ndrill_hole_depth_invalid_flag::number(38,0) as drill_hole_depth_invalid_flag,\ndrill_hole_angle_invalid_flag::number(38,0) as drill_hole_angle_invalid_flag,\ndrill_hole_position_invalid_flag::number(38,0) as drill_hole_position_invalid_flag,\ndw_time_between_drill_holes_seconds::number(38,0) as time_between_drill_holes_seconds,\nair_pressure_psi,\nfeed_force_newtons,\nrotation_torque_nm,\nbit_speed_rpm,\nwater_flow_gpm,\ninstantanous_penrate_mwd_meters_hour,\ndw_instantanous_penrate_mwd_feet_hour as instantanous_penrate_mwd_feet_hour,\ndw_drill_hole_off_target_feet as drill_hole_off_target_feet,\ndw_drill_hole_off_target_meters as drill_hole_off_target_meters,\ndw_drill_hole_horizontal_accuracy_pct::number(38,0) as drill_hole_horizontal_accuracy_pct,\ndw_drill_hole_vertical_accuracy_pct::number(38,0) as drill_hole_vertical_accuracy_pct,\ndw_overdrill_underdrill_flag::number(38,0) as overdrill_underdrill_flag,\ndw_overdrill_underdrill_feet as overdrill_underdrill_feet,\ndw_overdrill_underdrill_meters as overdrill_underdrill_meters,\ndrilling_stops_count::number(38,0) as drilling_stops_count,\ndw_drill_hole_redrill_flag::number(38,0) as drill_hole_redrill_flag,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.propel_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as propel_start_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.propel_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as propel_end_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.park_position_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as park_position_start_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.park_position_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as park_position_end_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.level_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as level_start_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.level_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as level_end_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.drill_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as drill_start_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.drill_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as drill_end_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.retract_start_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as retract_start_ts_utc,\n(convert_timezone(tz.tz_iana, 'UTC', rcs.retract_end_ts_local::TIMESTAMP_NTZ) || '+0000')::timestamp_tz as retract_end_ts_utc,\nconvert_timezone(tz.tz_iana, propel_start_ts_utc)::timestamp_tz as propel_start_ts_local,\nconvert_timezone(tz.tz_iana, propel_end_ts_utc)::timestamp_tz as propel_end_ts_local,\nconvert_timezone(tz.tz_iana, park_position_start_ts_utc)::timestamp_tz as park_position_start_ts_local,\nconvert_timezone(tz.tz_iana, park_position_end_ts_utc)::timestamp_tz as park_position_end_ts_local,\nconvert_timezone(tz.tz_iana, level_start_ts_utc)::timestamp_tz as level_start_ts_local,\nconvert_timezone(tz.tz_iana, level_end_ts_utc)::timestamp_tz as level_end_ts_local,\nconvert_timezone(tz.tz_iana, drill_start_ts_utc)::timestamp_tz as drill_start_ts_local,\nconvert_timezone(tz.tz_iana, drill_end_ts_utc)::timestamp_tz as drill_end_ts_local,\nconvert_timezone(tz.tz_iana, retract_start_ts_utc)::timestamp_tz as retract_start_ts_local,\nconvert_timezone(tz.tz_iana, retract_end_ts_utc)::timestamp_tz as retract_end_ts_local,\npropel_duration,\npark_position_duration,\nlevel_duration,\ndrill_duration,\nretract_duration,\nsystem_drill_state_duration_seconds::number(38,0) as system_drill_state_duration_seconds,\nsystem_setup_state_duration_seconds::number(38,0) as system_setup_state_duration_seconds,\nsystem_auto_level_duration_seconds::number(38,0)::number(38,0) as system_auto_level_duration_seconds,\nsystem_auto_delevel_duration_seconds::number(38,0) as system_auto_delevel_duration_seconds,\nplan_creation_ts_local::timestamp_tz as plan_creation_ts_local, -- Added this column because all other ts column showing 1984 or old data \nsystem_version,\nactual_mcf_block_id,\ndesign_mcf_block_id,\ndw_load_ts,\ndw_modify_ts\nfrom PROD_target.surfacemanager.rcs_drill_cycle_dt rcs\ninner join time_zones tz\non rcs.site_code = tz.dw_site_code\nunion all\nselect\norig_src_id,\nsite_code,\ndw_bench::varchar as bench,\ndw_pushback as pushback,\ndw_pattern_name as patter_name,\noriginal_pattern_name,\ndrill_cycle_sk,\ndrill_hole_shift_id,\ndw_drill_id as drill_id,\ndrill_bit_id,\nsystem_operator_id::varchar as system_operator_id, -- Operator id as name / id in the same column\ndrill_hole_id::varchar as drill_hole_id, -- Its coming as a number in caes so casted to varchar to match RCS\ndrill_hole_name,\ndrill_plan_sk,\ndrill_hole_status,\ndw_is_hole_planned_flag::number(38,0) as is_hole_planned_flag,\n(dw_start_hole_ts_utc || '+0000')::timestamp_tz as start_hole_ts_utc,\n(dw_end_hole_ts_utc || '+0000')::timestamp_tz as end_hole_ts_utc,\nconvert_timezone(tz.tz_iana, dw_start_hole_ts_utc)::timestamp_tz as start_hole_ts_local,\nconvert_timezone(tz.tz_iana, dw_end_hole_ts_utc)::timestamp_tz as end_hole_ts_local,\ndw_drill_hole_duration_seconds::number(38,0) as drill_hole_duration_seconds,\ndw_actual_drill_hole_depth_feet as actual_drill_hole_depth_feet,\nactual_drill_hole_depth_meters,\ngps_accuracy as gps_accuracy,\ndw_actual_drill_hole_start_feet_x as actual_drill_hole_start_feet_x,\ndw_actual_drill_hole_start_feet_y as actual_drill_hole_start_feet_y,\ndw_actual_drill_hole_start_feet_z as actual_drill_hole_start_feet_z,\ndw_actual_drill_hole_end_feet_x as actual_drill_hole_end_feet_x,\ndw_actual_drill_hole_end_feet_y as actual_drill_hole_end_feet_y,\ndw_actual_drill_hole_end_feet_z as actual_drill_hole_end_feet_z,\ndw_actual_drill_hole_longitude as actual_drill_hole_longitude,\ndw_actual_drill_hole_latitude as actual_drill_hole_latitude,\nactual_drill_hole_start_meters_x,\nactual_drill_hole_start_meters_y,\nactual_drill_hole_start_meters_z,\nactual_drill_hole_end_meters_x,\nactual_drill_hole_end_meters_y,\nactual_drill_hole_end_meters_z,\nautodrill_duration_seconds::number(38,0) as autodrill_duration_seconds,\nautodrill_usage_pct::number(38,0) as autodrill_usage_pct,\n-- dw_drill_hole_penetration_rate_avg_feet_hour_feet_hour as ,\ndw_drill_hole_penetration_rate_avg_feet_hour as drill_hole_penetration_rate_avg_feet_hour,\n(operator_login_ts_utc || '+0000')::timestamp_tz as operator_login_ts_utc,\n(operator_logout_ts_utc || '+0000')::timestamp_tz as operator_logout_ts_utc,\nconvert_timezone(tz.tz_iana, operator_login_ts_utc)::timestamp_tz as operator_login_ts_local,\nconvert_timezone(tz.tz_iana, operator_logout_ts_utc)::timestamp_tz as operator_logout_ts_local,\nbearing::number(38,1) as bearing,\ndrill_tower_angle_degree_calculated,\ndrill_tower_angle_degree_system,\ndrill_hole_duplicated_flag::number(38,0)::number(38,0) as drill_hole_duplicated_flag,\ndrill_hole_upside_down_flag::number(38,0) as drill_hole_upside_down_flag,\ndrill_hole_start_end_time_invalid_flag::number(38,0) as drill_hole_start_end_time_invalid_flag,\ndrill_hole_start_end_time_overlap_flag::number(38,0) as drill_hole_start_end_time_overlap_flag,\ndrill_hole_depth_invalid_flag::number(38,0) as drill_hole_depth_invalid_flag,\ndrill_hole_angle_invalid_flag::number(38,0) as drill_hole_angle_invalid_flag,\ndrill_hole_position_invalid_flag::number(38,0) as drill_hole_position_invalid_flag,\ndw_time_between_drill_holes_seconds::number(38,0) as time_between_drill_holes_seconds,\nair_pressure_psi,\nfeed_force_newtons,\nrotation_torque_nm,\nbit_speed_rpm,\nwater_flow_gpm,\ninstantanous_penrate_mwd_meters_hour,\ninstantanous_penrate_mwd_feet_hour,\ndrill_hole_off_target_feet,\ndrill_hole_off_target_meters,\ndrill_hole_horizontal_accuracy_pct::number(38,0) as drill_hole_horizontal_accuracy_pct,\ndrill_hole_vertical_accuracy_pct::number(38,0) as drill_hole_vertical_accuracy_pct,\noverdrill_underdrill_flag::number(38,0) as overdrill_underdrill_flag,\noverdrill_underdrill_feet,\noverdrill_underdrill_meters,\ndrilling_stops_count::number(38,0) as drilling_stops_count,\ndw_drill_hole_redrill_flag::number(38,0) as drill_hole_redrill_flag,\n(propel_start_ts_utc || '+0000')::timestamp_tz as propel_start_ts_utc,\n(propel_end_ts_utc || '+0000')::timestamp_tz as propel_end_ts_utc,\n(park_position_start_ts_utc || '+0000')::timestamp_tz as park_position_start_ts_utc,\n(park_position_end_ts_utc || '+0000')::timestamp_tz as park_position_end_ts_utc,\n(level_start_ts_utc || '+0000')::timestamp_tz as level_start_ts_utc,\n(level_end_ts_utc || '+0000')::timestamp_tz as level_end_ts_utc,\n(drill_start_ts_utc || '+0000')::timestamp_tz as drill_start_ts_utc,\n(drill_end_ts_utc || '+0000')::timestamp_tz as drill_end_ts_utc,\n(retract_start_ts_utc || '+0000')::timestamp_tz as retract_start_ts_utc,\n(retract_end_ts_utc || '+0000')::timestamp_tz as retract_end_ts_utc,\nconvert_timezone(tz.tz_iana, propel_start_ts_utc)::timestamp_tz as propel_start_ts_local,\nconvert_timezone(tz.tz_iana, propel_end_ts_utc)::timestamp_tz as propel_end_ts_local,\nconvert_timezone(tz.tz_iana, park_position_start_ts_utc)::timestamp_tz as position_start_ts_local,\nconvert_timezone(tz.tz_iana, park_position_end_ts_utc)::timestamp_tz as position_end_ts_local,\nconvert_timezone(tz.tz_iana, level_start_ts_utc)::timestamp_tz as level_start_ts_local,\nconvert_timezone(tz.tz_iana, level_end_ts_utc)::timestamp_tz as level_end_ts_local,\nconvert_timezone(tz.tz_iana, drill_start_ts_utc)::timestamp_tz as drill_start_ts_local,\nconvert_timezone(tz.tz_iana, drill_end_ts_utc)::timestamp_tz as drill_end_ts_local,\nconvert_timezone(tz.tz_iana, retract_start_ts_utc)::timestamp_tz as retract_start_ts_local,\nconvert_timezone(tz.tz_iana, retract_end_ts_utc)::timestamp_tz as retract_end_ts_local,\npropel_duration,\npark_position_duration,\nlevel_duration,\ndrill_duration,\nretract_duration,\nsystem_drill_state_duration_seconds::number(38,0) as system_drill_state_duration_seconds,\nsystem_setup_state_duration_seconds::number(38,0) as system_setup_state_duration_seconds,\nsystem_auto_level_duration_seconds::number(38,0) as system_auto_level_duration_seconds,\nsystem_auto_delevel_duration_seconds::number(38,0) as system_auto_delevel_duration_seconds,\nplan_creation_ts_local::timestamp_tz as plan_creation_ts_local, -- Added this column because all other ts column showing 1984 or old data \nsystem_version,\nactual_mcf_block_id,\ndesign_mcf_block_id,\ndw_load_ts,\ndw_modify_ts\nfrom PROD_target.catterrain.caes_drill_cycle_dt caes\ninner join time_zones tz\non caes.site_code = tz.dw_site_code",
        "warehouse": "WH_BATCH_DE"
      }
    }
  ],
  "env": {
    "database": "SANDBOX_DATA_ENGINEER",
    "role": "SG-AZW-SFLK-ENG-GENERAL",
    "schema": "CCARRILL2",
    "warehouse": "WH_BATCH_DE_NONPROD"
  },
  "generated_utc": "2026-01-06T19:56:11Z",
  "graph": {
    "edges": [
      {
        "from": {
          "db": "PROD_WG",
          "domain": "VIEW",
          "name": "DRILL_CYCLE",
          "schema": "DRILL_BLAST"
        },
        "to": {
          "db": "PROD_TARGET",
          "domain": "VIEW",
          "name": "DRILLBLAST_DRILL_CYCLE_V",
          "schema": "COLLECTIONS"
        }
      },
      {
        "from": {
          "db": "PROD_TARGET",
          "domain": "VIEW",
          "name": "DRILLBLAST_DRILL_CYCLE_V",
          "schema": "COLLECTIONS"
        },
        "to": {
          "db": "PROD_TARGET",
          "domain": "TABLE",
          "name": "DRILLBLAST_DRILL_CYCLE_C",
          "schema": "COLLECTIONS"
        }
      },
      {
        "from": {
          "db": "PROD_TARGET",
          "domain": "VIEW",
          "name": "DRILLBLAST_DRILL_CYCLE_V",
          "schema": "COLLECTIONS"
        },
        "to": {
          "db": "PROD_TARGET",
          "domain": "DYNAMIC TABLE",
          "name": "DRILLBLAST_DRILL_CYCLE_DT",
          "schema": "COLLECTIONS"
        }
      }
    ],
    "nodes_visited": 2
  },
  "notes": [],
  "root": {
    "db": "PROD_WG",
    "domain": "VIEW",
    "name": "DRILL_CYCLE",
    "schema": "DRILL_BLAST"
  },
  "show_object_dependencies": null,
  "show_object_dependencies_error": "001003 (42000): SQL compilation error:\nsyntax error line 1 at position 5 unexpected 'OBJECT'."
}