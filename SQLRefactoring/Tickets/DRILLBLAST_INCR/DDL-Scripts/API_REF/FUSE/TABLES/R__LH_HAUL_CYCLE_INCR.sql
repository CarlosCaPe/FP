create or replace TABLE LH_HAUL_CYCLE_INCR (
	HAUL_CYCLE_ID NUMBER(19,0) NOT NULL,
	SITE_CODE VARCHAR(4) COLLATE 'en-ci',
	ORIG_SRC_ID NUMBER(38,0),
	SHIFT_ID_AT_LOADING_END VARCHAR(12) COLLATE 'en-ci',
	SHIFT_ID_AT_DUMP_END VARCHAR(12) COLLATE 'en-ci',
	MATERIAL_ID NUMBER(19,0),
	ROUTING_SHAPE_ID NUMBER(19,0),
	LOADING_LOC_ID NUMBER(19,0),
	LOADING_LOC_NAME VARCHAR(255) COLLATE 'en-ci',
	LOADING_LOC_COORD_X FLOAT,
	LOADING_LOC_COORD_Y FLOAT,
	LOADING_LOC_ELEV FLOAT,
	LOADING_METHOD VARCHAR(50) COLLATE 'en-ci',
	DUMP_LOC_ID NUMBER(19,0),
	DUMP_LOC_NAME VARCHAR(255) COLLATE 'en-ci',
	DUMP_LOC_COORD_X FLOAT,
	DUMP_LOC_COORD_Y FLOAT,
	DUMP_LOC_ELEV FLOAT,
	CATEGORY_MATERIAL VARCHAR(50) COLLATE 'en-ci',
	CATEGORY_SOURCE_DESTINATION VARCHAR(100) COLLATE 'en-ci',
	EXCAV_ID NUMBER(19,0),
	EXCAV_OPERATOR_ID NUMBER(19,0),
	TRUCK_ID NUMBER(19,0),
	TRUCK_LOADING_OPERATOR_ID NUMBER(19,0),
	TRUCK_DUMPING_OPERATOR_ID NUMBER(19,0),
	REPORT_PAYLOAD_SHORT_TONS NUMBER(38,6),
	NOMINAL_PAYLOAD_SHORT_TONS NUMBER(38,6),
	MEASURED_PAYLOAD_METRIC_TONS NUMBER(38,6),
	AUTONOMOUS_FLAG NUMBER(1,0),
	OVERLOAD_FLAG NUMBER(1,0),
	CYCLE_START_TS_UTC TIMESTAMP_NTZ(3),
	CYCLE_END_TS_UTC TIMESTAMP_NTZ(3),
	CYCLE_START_TS_LOCAL TIMESTAMP_NTZ(3),
	CYCLE_END_TS_LOCAL TIMESTAMP_NTZ(3),
	EMPTY_TRAVEL_START_TS_UTC TIMESTAMP_NTZ(3),
	EMPTY_TRAVEL_END_TS_UTC TIMESTAMP_NTZ(3),
	EMPTY_TRAVEL_START_TS_LOCAL TIMESTAMP_NTZ(3),
	EMPTY_TRAVEL_END_TS_LOCAL TIMESTAMP_NTZ(3),
	EMPTY_TRAVEL_DURATION_MINS NUMBER(38,6),
	EMPTY_TRAVEL_DISTANCE_FEET NUMBER(38,6),
	EMPTY_TRAVEL_DISTANCE_METERS NUMBER(38,6),
	LOADING_START_TS_UTC TIMESTAMP_NTZ(3),
	LOADING_END_TS_UTC TIMESTAMP_NTZ(3),
	LOADING_START_TS_LOCAL TIMESTAMP_NTZ(3),
	LOADING_END_TS_LOCAL TIMESTAMP_NTZ(3),
	LOADING_DURATION_MINS NUMBER(38,6),
	FULL_TRAVEL_START_TS_UTC TIMESTAMP_NTZ(3),
	FULL_TRAVEL_END_TS_UTC TIMESTAMP_NTZ(3),
	FULL_TRAVEL_START_TS_LOCAL TIMESTAMP_NTZ(3),
	FULL_TRAVEL_END_TS_LOCAL TIMESTAMP_NTZ(3),
	FULL_TRAVEL_DURATION_MINS NUMBER(38,6),
	FULL_TRAVEL_DISTANCE_FEET NUMBER(38,6),
	FULL_TRAVEL_DISTANCE_METERS NUMBER(38,6),
	DUMPING_START_TS_UTC TIMESTAMP_NTZ(3),
	DUMPING_END_TS_UTC TIMESTAMP_NTZ(3),
	DUMPING_START_TS_LOCAL TIMESTAMP_NTZ(3),
	DUMPING_END_TS_LOCAL TIMESTAMP_NTZ(3),
	DUMPING_DURATION_MINS NUMBER(38,6),
	CYCLE_DURATION_MINS NUMBER(38,6),
	DELTA_C_MINS NUMBER(38,6),
	FUEL_USED_IN_CYCLE_GALLONS NUMBER(38,6),
	TCU_PCT NUMBER(38,6),
	XCU_PCT NUMBER(38,6),
	INSOL_PCT NUMBER(38,6),
	SYSTEM_VERSION VARCHAR(50) COLLATE 'en-ci',
	DW_LOGICAL_DELETE_FLAG VARCHAR(1) COLLATE 'en-ci' DEFAULT 'N',
	DW_LOAD_TS TIMESTAMP_NTZ(0),
	DW_MODIFY_TS TIMESTAMP_NTZ(0)
)COMMENT='Incremental table for LH_HAUL_CYCLE - MERGE-driven upserts with 3-day incremental window'
;
