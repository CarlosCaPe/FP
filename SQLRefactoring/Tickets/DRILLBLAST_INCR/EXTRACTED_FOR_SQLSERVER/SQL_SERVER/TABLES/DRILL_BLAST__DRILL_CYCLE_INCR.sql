/*****************************************************************************************
* TABLE     : DRILL_BLAST__DRILL_CYCLE_INCR
* DATABASE  : SNOWFLAKE_WG
* SCHEMA    : dbo
* SOURCE    : Snowflake DEV_API_REF.FUSE.DRILL_CYCLE_INCR
* DATE      : 2026-01-28 | AUTHOR: CARLOS CARRILLO
******************************************************************************************/
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DRILL_BLAST__DRILL_CYCLE_INCR]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[DRILL_BLAST__DRILL_CYCLE_INCR] (
    DRILL_CYCLE_SK BIGINT NOT NULL,
    ORIG_SRC_ID BIGINT,
    SITE_CODE NVARCHAR(5),
    BENCH NVARCHAR(MAX),
    PUSHBACK NVARCHAR(500),
    PATTERN_NAME NVARCHAR(500),
    ORIGINAL_PATTERN_NAME NVARCHAR(500),
    DRILL_HOLE_SHIFT_ID NVARCHAR(500),
    DRILL_ID BIGINT,
    DRILL_BIT_ID NVARCHAR(255),
    SYSTEM_OPERATOR_ID NVARCHAR(50),
    DRILL_HOLE_ID NVARCHAR(500),
    DRILL_HOLE_NAME NVARCHAR(500),
    DRILL_PLAN_SK BIGINT,
    DRILL_HOLE_STATUS BIGINT,
    IS_HOLE_PLANNED_FLAG BIGINT,
    START_HOLE_TS_UTC NVARCHAR(50),
    END_HOLE_TS_UTC NVARCHAR(50),
    OPERATOR_LOGIN_TS_UTC NVARCHAR(50),
    OPERATOR_LOGOUT_TS_UTC NVARCHAR(50),
    PROPEL_START_TS_UTC NVARCHAR(50),
    PROPEL_END_TS_UTC NVARCHAR(50),
    PARK_POSITION_START_TS_UTC NVARCHAR(50),
    PARK_POSITION_END_TS_UTC NVARCHAR(50),
    LEVEL_START_TS_UTC NVARCHAR(50),
    LEVEL_END_TS_UTC NVARCHAR(50),
    DRILL_START_TS_UTC NVARCHAR(50),
    DRILL_END_TS_UTC NVARCHAR(50),
    RETRACT_START_TS_UTC NVARCHAR(50),
    RETRACT_END_TS_UTC NVARCHAR(50),
    START_HOLE_TS_LOCAL NVARCHAR(50),
    END_HOLE_TS_LOCAL NVARCHAR(50),
    OPERATOR_LOGIN_TS_LOCAL NVARCHAR(50),
    OPERATOR_LOGOUT_TS_LOCAL NVARCHAR(50),
    PROPEL_START_TS_LOCAL NVARCHAR(50),
    PROPEL_END_TS_LOCAL NVARCHAR(50),
    PARK_POSITION_START_TS_LOCAL NVARCHAR(50),
    PARK_POSITION_END_TS_LOCAL NVARCHAR(50),
    LEVEL_START_TS_LOCAL NVARCHAR(50),
    LEVEL_END_TS_LOCAL NVARCHAR(50),
    DRILL_START_TS_LOCAL NVARCHAR(50),
    DRILL_END_TS_LOCAL NVARCHAR(50),
    RETRACT_START_TS_LOCAL NVARCHAR(50),
    RETRACT_END_TS_LOCAL NVARCHAR(50),
    PLAN_CREATION_TS_LOCAL NVARCHAR(50),
    DRILL_HOLE_DURATION_SECONDS BIGINT,
    AUTODRILL_DURATION_SECONDS BIGINT,
    TIME_BETWEEN_DRILL_HOLES_SECONDS BIGINT,
    SYSTEM_DRILL_STATE_DURATION_SECONDS BIGINT,
    SYSTEM_SETUP_STATE_DURATION_SECONDS BIGINT,
    SYSTEM_AUTO_LEVEL_DURATION_SECONDS BIGINT,
    SYSTEM_AUTO_DELEVEL_DURATION_SECONDS BIGINT,
    PROPEL_DURATION DECIMAL(36,6),
    PARK_POSITION_DURATION DECIMAL(36,6),
    LEVEL_DURATION DECIMAL(36,6),
    DRILL_DURATION DECIMAL(36,6),
    RETRACT_DURATION DECIMAL(36,6),
    ACTUAL_DRILL_HOLE_DEPTH_FEET DECIMAL(38,5),
    ACTUAL_DRILL_HOLE_DEPTH_METERS DECIMAL(38,5),
    ACTUAL_DRILL_HOLE_START_FEET_X DECIMAL(38,5),
    ACTUAL_DRILL_HOLE_START_FEET_Y DECIMAL(38,5),
    ACTUAL_DRILL_HOLE_START_FEET_Z DECIMAL(38,5),
    ACTUAL_DRILL_HOLE_END_FEET_X DECIMAL(38,5),
    ACTUAL_DRILL_HOLE_END_FEET_Y DECIMAL(38,5),
    ACTUAL_DRILL_HOLE_END_FEET_Z DECIMAL(38,5),
    ACTUAL_DRILL_HOLE_START_METERS_X DECIMAL(38,5),
    ACTUAL_DRILL_HOLE_START_METERS_Y DECIMAL(38,5),
    ACTUAL_DRILL_HOLE_START_METERS_Z DECIMAL(38,5),
    ACTUAL_DRILL_HOLE_END_METERS_X DECIMAL(38,5),
    ACTUAL_DRILL_HOLE_END_METERS_Y DECIMAL(38,5),
    ACTUAL_DRILL_HOLE_END_METERS_Z DECIMAL(38,5),
    GPS_ACCURACY BIGINT,
    ACTUAL_DRILL_HOLE_LONGITUDE FLOAT,
    ACTUAL_DRILL_HOLE_LATITUDE FLOAT,
    AUTODRILL_USAGE_PCT BIGINT,
    DRILL_HOLE_PENETRATION_RATE_AVG_FEET_HOUR DECIMAL(38,5),
    INSTANTANOUS_PENRATE_MWD_METERS_HOUR DECIMAL(38,5),
    INSTANTANOUS_PENRATE_MWD_FEET_HOUR DECIMAL(38,5),
    BEARING DECIMAL(38,1),
    DRILL_TOWER_ANGLE_DEGREE_CALCULATED DECIMAL(38,5),
    DRILL_TOWER_ANGLE_DEGREE_SYSTEM DECIMAL(38,5),
    DRILL_HOLE_DUPLICATED_FLAG BIGINT,
    DRILL_HOLE_UPSIDE_DOWN_FLAG BIGINT,
    DRILL_HOLE_START_END_TIME_INVALID_FLAG BIGINT,
    DRILL_HOLE_START_END_TIME_OVERLAP_FLAG BIGINT,
    DRILL_HOLE_DEPTH_INVALID_FLAG BIGINT,
    DRILL_HOLE_ANGLE_INVALID_FLAG BIGINT,
    DRILL_HOLE_POSITION_INVALID_FLAG BIGINT,
    DRILL_HOLE_OFF_TARGET_FEET DECIMAL(38,5),
    DRILL_HOLE_OFF_TARGET_METERS DECIMAL(38,5),
    DRILL_HOLE_HORIZONTAL_ACCURACY_PCT BIGINT,
    DRILL_HOLE_VERTICAL_ACCURACY_PCT BIGINT,
    OVERDRILL_UNDERDRILL_FLAG BIT,
    OVERDRILL_UNDERDRILL_FEET DECIMAL(38,5),
    OVERDRILL_UNDERDRILL_METERS DECIMAL(38,5),
    DRILLING_STOPS_COUNT BIGINT,
    DRILL_HOLE_REDRILL_FLAG BIGINT,
    AIR_PRESSURE_PSI DECIMAL(38,5),
    FEED_FORCE_NEWTONS DECIMAL(38,5),
    ROTATION_TORQUE_NM DECIMAL(38,5),
    BIT_SPEED_RPM DECIMAL(38,5),
    WATER_FLOW_GPM DECIMAL(38,5),
    ACTUAL_MCF_BLOCK_ID NVARCHAR(MAX),
    DESIGN_MCF_BLOCK_ID NVARCHAR(MAX),
    SYSTEM_VERSION NVARCHAR(11),
    DW_LOAD_TS DATETIME2,
    DW_MODIFY_TS DATETIME2,
    DW_LOGICAL_DELETE_FLAG NVARCHAR(1) DEFAULT 'N',
    DW_ROW_HASH NVARCHAR(64),
    CONSTRAINT PK_DRILL_BLAST__DRILL_CYCLE_INCR PRIMARY KEY (DRILL_CYCLE_SK)
);
END
GO

-- Create index for archival queries
IF NOT EXISTS (SELECT * FROM sys.indexes WHERE name = 'IX_DRILL_BLAST__DRILL_CYCLE_INCR_DW_MODIFY_TS')
CREATE INDEX IX_DRILL_BLAST__DRILL_CYCLE_INCR_DW_MODIFY_TS ON [dbo].[DRILL_BLAST__DRILL_CYCLE_INCR](DW_MODIFY_TS);
GO
