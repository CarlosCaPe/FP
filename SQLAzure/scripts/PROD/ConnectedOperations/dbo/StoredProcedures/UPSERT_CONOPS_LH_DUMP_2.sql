
/******************************************************************    
* PROCEDURE : dbo.[UPSERT_CONOPS_LH_DUMP_2]  
* PURPOSE : Upsert [UPSERT_CONOPS_LH_DUMP_2]  
* NOTES     :   
* CREATED : mfahmi  
* SAMPLE    : EXEC dbo.[UPSERT_CONOPS_LH_DUMP_2]  
* MODIFIED DATE  AUTHOR    DESCRIPTION    
*------------------------------------------------------------------    
* {10 JAN 2023}  {mfahmi}   {Initial Created}    
*******************************************************************/    
CREATE  PROCEDURE [dbo].UPSERT_CONOPS_LH_DUMP_2 
AS  
BEGIN  
  
MERGE dbo.LH_DUMP_2 AS T   
USING (SELECT   
SHIFTINDEX
,CALCULATED_SHIFTINDEX
,SHIFTDATE
,SITE_CODE
,CLIID
,DDBKEY
,DUMPID
,BAY
,BLAST
,DUMP_BLAST
,CALCTRAVTI
,DIST
,DUMPINGTIM
,DUMPTONS
,EFH
,EOPER
,EXCAV
,EXCAV_ORIG
,EXTRALOAD
,GRADE
,HOS
,IDLETIME
,IDMP
,INTVL
,LIFT_DOWN
,LIFT_UP
,LIFTDIST_D
,LIFTDIST_U
,LOAD
,LOADNUMBER
,LOADOLD
,LOADREC
,LOADTYPE
,LOC
,MEASURETON
,OPER
,SHIFTLINK
,TIMEARRIVE
,TIMEARRIVE_TS
,TIMEDIGEST
,TIMEDIGEST_TS
,TIMEDUMP
,TIMEDUMP_TS
,TIMEEMPTY
,TIMEEMPTY_TS
,TRUCK
,TRUCK_ORIG
,VAL_DMP
,GPSX
,GPSY
,DLOCK
,ELOCK
,EDLOCK
,RLOCK
,GPSSTAT
,GPS_HEADING
,GPS_VELOCITY
,TBARS0
,TBARS1
,TBARS2
,TBARS3
,BLEND_CODE
,BLEND
,TMBARS0_CODE
,TMBARS0
,TMBARS1_CODE
,TMBARS1
,TMBARS2_CODE
,TMBARS2
,TMBARS3_CODE
,TMBARS3
,TMBARS4_CODE
,TMBARS4
,TMBARS5_CODE
,TMBARS5
,SYSTEM_VERSION
,UTC_CREATED_DATE
   
 FROM dbo.LH_DUMP_stg_2) AS S   
 ON (T.shiftindex = S.shiftindex   
 AND T.shiftdate = S.shiftdate   
 AND T.site_code = S.site_code   
 AND T.ddbkey = S.ddbkey  
 AND T.CLIID = S.CLIID)   
  
 WHEN MATCHED   
 THEN UPDATE SET   
 --,T.SHIFTINDEX = S.SHIFTINDEX
T.CALCULATED_SHIFTINDEX = S.CALCULATED_SHIFTINDEX
--,T.SHIFTDATE = S.SHIFTDATE
--,T.SITE_CODE = S.SITE_CODE
--,T.CLIID = S.CLIID
--,T.DDBKEY = S.DDBKEY
,T.DUMPID = S.DUMPID
,T.BAY = S.BAY
,T.BLAST = S.BLAST
,T.DUMP_BLAST = S.DUMP_BLAST
,T.CALCTRAVTI = S.CALCTRAVTI
,T.DIST = S.DIST
,T.DUMPINGTIM = S.DUMPINGTIM
,T.DUMPTONS = S.DUMPTONS
,T.EFH = S.EFH
,T.EOPER = S.EOPER
,T.EXCAV = S.EXCAV
,T.EXCAV_ORIG = S.EXCAV_ORIG
,T.EXTRALOAD = S.EXTRALOAD
,T.GRADE = S.GRADE
,T.HOS = S.HOS
,T.IDLETIME = S.IDLETIME
,T.IDMP = S.IDMP
,T.INTVL = S.INTVL
,T.LIFT_DOWN = S.LIFT_DOWN
,T.LIFT_UP = S.LIFT_UP
,T.LIFTDIST_D = S.LIFTDIST_D
,T.LIFTDIST_U = S.LIFTDIST_U
,T.LOAD = S.LOAD
,T.LOADNUMBER = S.LOADNUMBER
,T.LOADOLD = S.LOADOLD
,T.LOADREC = S.LOADREC
,T.LOADTYPE = S.LOADTYPE
,T.LOC = S.LOC
,T.MEASURETON = S.MEASURETON
,T.OPER = S.OPER
,T.SHIFTLINK = S.SHIFTLINK
,T.TIMEARRIVE = S.TIMEARRIVE
,T.TIMEARRIVE_TS = S.TIMEARRIVE_TS
,T.TIMEDIGEST = S.TIMEDIGEST
,T.TIMEDIGEST_TS = S.TIMEDIGEST_TS
,T.TIMEDUMP = S.TIMEDUMP
,T.TIMEDUMP_TS = S.TIMEDUMP_TS
,T.TIMEEMPTY = S.TIMEEMPTY
,T.TIMEEMPTY_TS = S.TIMEEMPTY_TS
,T.TRUCK = S.TRUCK
,T.TRUCK_ORIG = S.TRUCK_ORIG
,T.VAL_DMP = S.VAL_DMP
,T.GPSX = S.GPSX
,T.GPSY = S.GPSY
,T.DLOCK = S.DLOCK
,T.ELOCK = S.ELOCK
,T.EDLOCK = S.EDLOCK
,T.RLOCK = S.RLOCK
,T.GPSSTAT = S.GPSSTAT
,T.GPS_HEADING = S.GPS_HEADING
,T.GPS_VELOCITY = S.GPS_VELOCITY
,T.TBARS0 = S.TBARS0
,T.TBARS1 = S.TBARS1
,T.TBARS2 = S.TBARS2
,T.TBARS3 = S.TBARS3
,T.BLEND_CODE = S.BLEND_CODE
,T.BLEND = S.BLEND
,T.TMBARS0_CODE = S.TMBARS0_CODE
,T.TMBARS0 = S.TMBARS0
,T.TMBARS1_CODE = S.TMBARS1_CODE
,T.TMBARS1 = S.TMBARS1
,T.TMBARS2_CODE = S.TMBARS2_CODE
,T.TMBARS2 = S.TMBARS2
,T.TMBARS3_CODE = S.TMBARS3_CODE
,T.TMBARS3 = S.TMBARS3
,T.TMBARS4_CODE = S.TMBARS4_CODE
,T.TMBARS4 = S.TMBARS4
,T.TMBARS5_CODE = S.TMBARS5_CODE
,T.TMBARS5 = S.TMBARS5
,T.SYSTEM_VERSION = S.SYSTEM_VERSION
,T.UTC_CREATED_DATE = S.UTC_CREATED_DATE   
 WHEN NOT MATCHED   
 THEN INSERT (   
 SHIFTINDEX
,CALCULATED_SHIFTINDEX
,SHIFTDATE
,SITE_CODE
,CLIID
,DDBKEY
,DUMPID
,BAY
,BLAST
,DUMP_BLAST
,CALCTRAVTI
,DIST
,DUMPINGTIM
,DUMPTONS
,EFH
,EOPER
,EXCAV
,EXCAV_ORIG
,EXTRALOAD
,GRADE
,HOS